# 数字逻辑层

标签（空格分隔）： 前端知识体系

---

## 门

制造数字计算机的硬件基础

![门](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/gate.png)

### 逻辑值

数字电路只能表示两个逻辑值

* 0~0.5V表示一个值，如二进制0
* 1~1.5V表示另一个值，如二进制1

### 晶体管

作为一个快速二进制开关，有三个管脚：集极、基极、射极

* 基极的电压小于某个值时，晶体管是断开的，相当于一个无穷大的电阻
* 基极的电压大于某个值时，晶体管是连通的，相当于导线

### 非门

带一个二级晶体管的简单电路

* 输入电压低于某个值时，输出电压接近外接基准电压
* 输入电压高于某个值时，输出电压接地

| A | X |
| --- | --- |
| 0 | 1 |
| 1 | 0 |

![非门](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/NOT-gate.png)

### 与非门

两个晶体管串联

* V1、V2同时为高时，输出电压接地
* 其他情况输出电压接近外接基准电压

| A | B | X |
| --- | --- | --- |
| 0 | 0 | 1 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 0 |

![与非门](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/NAND-gate.png)

### 或非门

两个晶体管并联

* V1、V2有一个为高电压时，输出电压接地
* 其他情况输出电压接近外接基准电压

| A | B | X |
| --- | --- | --- |
| 0 | 0 | 1 |
| 0 | 1 | 0 |
| 1 | 0 | 0 |
| 1 | 1 | 0 |

![或非门](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/NOR-gate.png)

### 与门

与非门串联一个非门组成，都为真时才为真

| A | B | X |
| --- | --- | --- |
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 1 |

### 或门

或非门串联一个非门组成，有一个为真时为真

| A | B | X |
| --- | --- | --- |
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 1 |

### 异或门

不同时为真

| A | B | X |
| --- | --- | --- |
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 0 |

## 布尔代数

输入和输出都只能是0或1

### 真值表

表格的每一行描述一种输入组合对应的函数值

* n个变量的布尔函数的输入有2^n种组合
* n个变量的布尔函数的结果可以用2^n位二进制值表示

### 布尔公式

使用哪些输入组合可以使函数值为1来描述布尔函数

* 输入变量上面加一横线表示非
* 隐含的乘号或小圆点表示与
* 加号表示或

![布尔公式](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/boolean-formula.png)

### 布尔电路

使用布尔电路实现布尔函数

1. 写出该函数的真值表
2. 根据真值表得到布尔公式
3. 根据布尔公式得到布尔电路

![布尔函数](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/boolean-circuit.png)

### 布尔恒等式

每个等式有两种对称的形式，将与或及01互换，可以得到另一种形式

![布尔恒等式](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/boolean-identity.png)

根据恒等式，可以将门进行转换

![门转换1](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/gate-convert-1.png)

![门转换2](https://raw.githubusercontent.com/wchaochao/images/master/gitbook-computer-composition/gate-convert-2.png)

## 基本数字逻辑电路

以多个门组成的模块为基本组件

### 组合逻辑电路

有多个输入信号和多个输出信号，且输出信号由输入信号决定

#### 多路选择器

根据控制信号选择某个输入，有n个控制信号，2^n个输入信号，1个输出信号

* 每种控制信号的组合都会筛选出对应的输入信号
* 输入信号确定时，相当于一个确定的真值表
* 通过遍历控制信号的组合，可以将并行信号转换为串行信号

![多路选择器](112)

#### 译码器

根据输入信号选中某个输出信号，有n个输入信号，2^n个输出信号

* 每种输入信号的组合都会有对应的输出信号为1，其他为0

![译码器](114)

#### 比较器

比较输入的两个字，有2n个输入信号，1个输出信号

* 输入信号两两相同时，输出为1，否则为0

![比较器](114)

### 算术电路

#### 移位器

左移或右移，有1个控制信号，n个输入信号，n个输出信号

* 控制信号为0时左移，1时右移，空位补0

![移位器](115)

#### 半加器

两个1位数相加产生和、进位

![半加器](116)

#### 全加器

两个1位数、低位进位相加产生和、高位进位

![全加器](116)

#### 加法器

多个全加器相连

* 行波进位加法器：从低位往高位依次全加运算
* 进位选择加法器：低位和高位并行全加运算，然后根据低位产生的最终进位，选择一个高位全加运算结果

#### 算术逻辑单元

完成两个机器字的与、或、求和运算

* 根据F0、F1选择信号进行与、或、非、求和运算
* ENA为0时会强制A为0
* ENB为0时会强制B为0
* INVA为1时会对A求反

![算术逻辑单元](117)

### 时钟

一种特定的电路，发出一系列的脉冲，脉冲的宽度相同，两个连续脉冲之间的间隔也相同

* 时钟周期：两个连续脉冲之间相应边沿的时间间隔
* 子时钟周期：在主时钟周期上接出一个信号，延迟一个已知的延时，用于处理同一时钟周期的事件顺序
* 非对称时钟：时钟信号在高位和低位的时间不同

![时钟](119)

### 集成电路

在一小块方形的硅片上集成多个门电路

* DIP：双排直插式封装
* PGA：引脚阵列封装
* LGA：触点阵列封装

### 现场可编程门阵列

FPGA，包含可编辑逻辑的芯片，由查找表LUT和可编程内部连线PI组成，通过配置数据可以转变成任意功能的逻辑电路，用于产品的原型设计

## 内存

用来存放计算机执行的指令和执行指令用到的数据

### 锁存器

记录上一次输入的值，采用电平触发

#### SR锁存器

输入信号S、R，输出信号Q、Q反

* S=R=0时，输出信号Q可以为0和1，锁存器状态不变
* S=1，R=0时，输出信号Q只能为1，设置锁存器
* S=0，R=1时，输出信号Q只能为0，重置锁存器
* S=R=1时，输出信号Q、Q反都为0，当输入都变为0时，输出将由后一个变为0的输入决定

![SR锁存器](119)

#### 时钟SR锁存器

添加一个时钟作为额外的输入

* 时钟信号为0时，不会改变锁存器状态
* 时钟信号为1时，锁存器对S和R的变化起反应

![时钟SR锁存器](121)

#### 时钟D锁存器

使用1个输入防止出现S=R=1的情况，一位存储器

* 时钟信号为0时，不会改变锁存器状态
* 时钟信号为1时，锁存器存入D值

![时钟D锁存器](121)

### 触发器

在特定时刻对某个信号采样并加以存储，采用边沿触发

#### 脉冲发生器

利用非门有个微小的、但不为0的传输延迟，在时钟上升沿时制造一个短脉冲

![脉冲发生器](121)

#### D触发器

脉冲发生器加D锁存器

![D触发器](122)

### 寄存器

多个触发器组合在一起组成寄存器，保存超过一位长的数据

![寄存器](123)

### 三态器

可以输出0、1和非0非1（电路开路）三种状态

#### 非反向缓冲器

相当于开关，有1个输入、1个输出、1个控制信号

* 控制信号为1时，电路连通
* 控制信号为0时，电路断开

![非反向缓冲器](125)

#### 反向缓冲器

非门和开关的复合，有1个输入、1个输出、1个控制信号

* 控制信号为1时，为非门
* 控制信号为0时，电路断开

![反向缓冲器](125)

### 内存组成

为每个内存字进行编址

* 输入信号I0、I1、I2与所有D触发器的D相连
* 地址信号A0、A1通过译码器选择一个字
* 片选信号CS为0时，不能读取、不能写入
* 片选信号为1时
 * 读写信号RD为1，进行读操作，输出使能信号OE为1时可以输出
 * 读写信号RD为0，进行写操作，不能输出

![4×3存储器](124)

### 内存芯片

对存储器字数和字位进行扩展，集成在一个芯片上，需要考虑输出的位数和地址如何确定

* 片选信号CS表示选中某个芯片进行读写
* 写使能信号WE表示进行写操作
* 输出使能信号OE表示驱动芯片数据输出
* 行地址信号RAS表示选中行
* 列地址信号CAS表示选中列
* 存储体信号Bank表示选中芯片中的某个存储体

![内存芯片](127)

### RAM

随机访问存储器，可读写

* SRAM：静态RAM，内部采用类型D触发器的电路，只要不断电，就可以永久存储数据，用于高速缓存
* DRAM：动态RAM，使用晶体管和电容组成的存储单元来存储数据，由于电容中的电荷会泄露，需要不断的刷新，用于主存
 * FPM：快页DRAM，最老的DRAM，内部为存储位矩阵，通过行地址、列地址寻址
 * EDO：扩展数据输出DRAM，允许在前一个内存访问周期结束之前启动第二个内存访问周期
 * SDRAM：同步DRAM，静态和动态RAM的结合，统一由系统时钟驱动，省去了与内存芯片握手的控制信号
 * DDR SDRAM：双倍数据速率SDRAM，可在时钟的上升沿和下降沿均输出数据，使数据速率提高了一倍

### ROM

只读存储器，不能改变或擦除

* PROM：可编程ROM，可在现场编程（一次）
* EPROM：可擦除PROM，可以现场编程、现场擦除，通过紫外线全部擦除
* EEPROM：通过脉冲擦除某个字节
* 闪存：按块进行擦除和重写

## CPU

通过管脚与外部世界通信

### 管脚

通过总线和内存、输入/输出设备的相应管脚相连

* 地址信号：可以寻址2^m的地址空间
* 数据信号：一次读写n位的字
* 控制信号：调整进出CPU的数据流和时间
 * 总线控制信号：CPU给内存或输入/输出设备的信号
 * 中断信号：输入/输出设备给CPU的信号，要求CPU响应
 * 总线仲裁信号：控制总线流量，防止两个设备在同一时刻使用总线
 * 协处理器信号：和协处理器协作的信号，如浮点运算芯片、图形处理芯片
 * 状态信号：提供或接收状态信息
 * 其他控制信号：如电源、接地、时钟信号

![CPU管脚](131)

### Intel Core i7

## 总线

计算机中多个设备公用的电子通道

* 主设备通过总线驱动器和总线相连
* 从设备通过总线接收器和总线相连
* 既能做主设备又能做从设备的设备通过总线转发器和总线相连
* 总线接口芯片通常是三态门，设备不需要和总线连接时和总线断开，需要时采用类似集电极开路的方式与总线连接

![多总线计算机系统](132)

### 总线宽度

* 地址信号线：越多寻址空间越大，
* 数据信号线：越多数据带宽越大

### 总线时钟

#### 同步总线

有总线时钟，总线操作都占用整数个总线周期

![同步总线](136)

#### 异步总线

无总线时钟，总线操作总是尽快完成

![异步总线](138)

### 总线仲裁

仲裁多个设备同时使用总线的情况

#### 集中式

总线控制器发现总线请求后，发起总线授权，授权给优先级高、距离近的设备

![集中式总线仲裁](139)

#### 竞争式

所有设备监听总线使用情况，总线空闲时由优先级高的设备使用总线

![竞争式总线仲裁](140)

### 总线操作

#### 成块传送

一次传送多个字

![成块传送](141)

#### 中断处理

由中断控制器统一处理

![中断处理](141)
