# Web防御机制

标签（空格分隔）： 前端知识体系

---

* 防止用户获得未授权访问
* 防止错误输入造成不良行为
* 防范攻击者
* 管理应用程序

## 处理用户访问

使用三层相互关联的安全机制处理用户访问

* 身份验证
* 会话管理
* 访问控制

### 用户

* 匿名用户
* 正常通过验证的用户
* 管理用户

### 身份验证

确定用户的真实身份

* 传统的身份验证模型：用户名 + 密码
* 其他身份验证模型：令牌、证书

关联功能

* 注册
* 修改密码
* 忘记密码

### 会话管理

管理通过验证的用户的会话

* 会话：一组保存在服务器上的数据结构，用于追踪用户与应用程序的交互状态
* 令牌：映射到会话中，将请求与用户联系起来

### 访问控制

 决定是否授权用户执行其请求的操作或访问相关数据

## 处理用户输入

所有用户输入都不可信

* 用户可干预客户端与服务器间传送的所有数据，包括请求参数，cookie，HTTP请求头
* 用户可按任意顺序发送请求
* 用户可以使用浏览器之外的客户端访问应用程序

### 输入确认

* 对应用程序输入的字段进行验证
* 对服务器写入应用程序的字段进行确认
* 对服务器每一个功能单元的输入进行净化

### 输入处理

* 黑名单：拒绝已知的不良输入，容易被避开
* 白名单：接受已知的正常输入，有时必须接受不标准的数据
* 净化：删除、编码、转义恶意字符，只留下安全字符，要注意净化后的字符是否又变成了恶意字符
* 安全处理：使用安全的编程方法避免SQL注入、命令行执行等常见问题

## 处理攻击者

以受控的方式处理并应对攻击

* 处理错误
* 维护审计日志
* 向管理员发出警报
* 应对攻击

### 处理错误

合理的处理无法预料的错误

* 纠正错误
* 向用户发送适当的错误信息，不应返回敏感信息

### 维护审计日志

日志应记录所有重要事件的发生时间、请求的IP地址、用户账号等信息，必须受到严格的保护，避免未授权的读取或访问

* 与身份验证有关的事件，如登录、密码修改
* 关键交易，如支付、转账
* 被访问控制机制阻止的请求
* 包含攻击字符串的恶意请求

### 向管理员发出警报

既准确报告每次的真实攻击，又不会生成过多的警报

* 应用反常，如收到一个IP下的大量请求
* 交易反常
* 普通用户无法访问的数据被修改
* 包含攻击字符串的恶意请求

### 应对攻击

给攻击者设置更多阻碍

* 对攻击者提交的请求响应速度越来越慢
* 终止攻击者的会话

## 管理应用程序

应用程序的后台管理系统，是应用程序的主要受攻击面

* 通过身份验证机制中的薄弱环节获得管理员权限
* 利用管理功能访问控制的漏洞建立拥有强大特权的用户账号
* 通过跨站点脚本攻击窃取管理界面的信息
